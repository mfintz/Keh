<!DOCTYPE html>
<html>
	<head>
		<title>Average working hours in a week according to OECD</title>
	<style>
		p {color:gray; position: relative; left: 320px; font-size: 25px;}
	</style>
	</head>
	<body>
		<p>Average working hours in a week according to OECD</p>
		<meta charset="utf-8">
				<style>
					text {
					  font: 10px sans-serif;
					  text-anchor: middle;
					}

					.node circle {
					  fill: #ddd;
					}

					.node:hover circle {
					  stroke: #000;
					  stroke-width: 1.2px;
					}
				</style>
				<svg width="960" height="960"><g transform="translate(1,1)"></g></svg>
				<script src="//d3js.org/d3.v4.0.0-alpha.35.min.js"></script>
				<script>
				var svg = d3.select("svg"),
				    width = +svg.attr("width"),
				    height = +svg.attr("height");

				var men = "Men",
					women = "Women";

				var pack = d3.pack()
				    .size([width - 2, height - 2])
				    .padding(3);

				d3.csv("finalAllDraft.csv", type, function(error, data) {
				  if (error) throw error;
				  var data = data.filter(function(d) 
				  { 
				     if(d["Sex"] == "Men") 
				     { 
				         console.log(d.Country);
				         return d;
				     }
				  })
				  console.log(data)
				   var root = d3.hierarchy({children: data})
				      .sum(function(d) { return d.Value; })
				      .sort(function(a, b) { return b.Value - a.Value; });

				  pack(root);
				  var node = svg.select("g")
				    .selectAll("g")
				    .data(root.children)
				    .enter().append("g")
				      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
				      .attr("class", "node");

				  node.append("circle")
				      .style("fill", "#87CEEB")
				      .attr("Country", function(d) { return "node-" + d.Country; })
				      .attr("r", function(d) { return d.r; });

				  node.append("clipPath")
				      .attr("Country", function(d) { return "clip-" + d.data.Country; })
				    .append("use")
				      .attr("xlink:href", function(d) { return "#node-" + d.data.Country + ""; });

				  node.append("text")
				  	.attr("text-color", "blue")
				  	.style("font-size", "12px")
				  	.style("fill", "black")
				  	.attr("transform","translate(0,-10)")
				    .attr("clip-path", function(d) { return "url(#clip-" + d.data.Country + ")"; })
				    .selectAll("tspan")
				      .data(function(d) 
				      { 
				      	return d.data.Country.split(".").pop().split(/(?=[A-Z][^A-Z])/g); 
				      })
				    .enter().append("tspan")
				      .attr("x", 0)
				      .attr("y", function(d, i, nodes) { return 13 + (i - nodes.length / 2 - 0.5) * 10; })
				      .text(function(d) { return d; });

				  node.append("title")
				      .text(function(d) { return d.data.Country + "\n" + d.data.Value; });
				  node.append("text")
				    .style("font-size", "12px")
				    .style("fill", "black")
				  	.attr("transform","translate(0,10)")
				  	.text(function(d) { return (Math.round(d.data.Value*100)/100).toString();});
				});
				function type(d) {
				  return (d.Value = +d.Value) ? d : null;
				}
				</script>
		</body>
</html>